{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "sigil://spec/components",
  "title": "Sigil Component Configurations",
  "description": "Component configuration types for different visualisation types.\n\nComponent-specific configuration using discriminated unions. Each component type has its own config interface with a discriminator field that matches the ComponentType. This provides type safety - when you know the component type, TypeScript narrows to the correct config.\n\nAll configs share common properties (title, description, affordances) plus type-specific properties defined in each interface",
  "definitions": {
    "ComponentConfig": {
      "description": "Discriminated union of all component configuration types",
      "anyOf": [
        {
          "$ref": "#/definitions/DataTableConfig"
        },
        {
          "$ref": "#/definitions/HierarchyConfig"
        },
        {
          "$ref": "#/definitions/CompositionConfig"
        },
        {
          "$ref": "#/definitions/TextInsightConfig"
        }
      ],
      "discriminator": {
        "propertyName": "type",
        "mapping": {
          "data-table": "#/definitions/DataTableConfig",
          "hierarchy": "#/definitions/HierarchyConfig",
          "composition": "#/definitions/CompositionConfig",
          "text-insight": "#/definitions/TextInsightConfig"
        }
      }
    },
    "DataTableColumn": {
      "description": "Column configuration for data table components.\n\nDefines display properties for a single column. The accessor references a field in accessor_bindings, linking display config to data semantics.\n\nColumn order in the array determines display order (left-to-right).\n\nSortability and filterability are derived from affordances, not defined per-column.",
      "additionalProperties": false,
      "properties": {
        "accessor": {
          "type": "string",
          "description": "JSONPath accessor referencing a field in accessor_bindings. Examples: 'name', 'user.email', 'metadata.created_at'"
        },
        "label": {
          "type": "string",
          "description": "Human-readable column header text"
        },
        "width": {
          "$ref": "./primitives.schema.json#/definitions/SizeConstraint",
          "description": "Column width constraint. Supports fixed pixels, flex proportions, percentages, or content-based sizing. Omit for default table layout behaviour"
        },
        "alignment": {
          "type": "string",
          "enum": ["left", "center", "right"],
          "description": "Horizontal alignment of cell content. Default: 'left' for text, 'right' for numbers"
        },
        "visible": {
          "type": "boolean",
          "description": "Whether the column is visible. Hidden columns remain in the spec but are not rendered. Default: true"
        },
        "description": {
          "type": "string",
          "description": "Optional description for tooltip or help text"
        }
      },
      "required": ["accessor", "label"],
      "type": "object"
    },
    "DataTableConfig": {
      "description": "Configuration for data table components.\n\nData tables display tabular data with rows and columns, supporting common tabular operations like sorting, filtering, and pagination.\n\nBest used with: data_shape = 'tabular'",
      "additionalProperties": false,
      "properties": {
        "affordances": {
          "items": {
            "$ref": "./affordances.schema.json#/definitions/Affordance"
          },
          "type": "array",
          "description": "Interactive capabilities enabled for this table. Common affordances: sorting, filtering, pagination, virtualisation, search, export"
        },
        "columns": {
          "items": {
            "$ref": "#/definitions/DataTableColumn"
          },
          "type": "array",
          "description": "Column definitions specifying which fields to display and how to render them. Column order determines display order (left-to-right). Each column's accessor must reference a field in accessor_bindings"
        },
        "description": {
          "type": "string",
          "description": "Optional description explaining the component's purpose"
        },
        "title": {
          "type": "string",
          "description": "Optional title for the component"
        },
        "type": {
          "const": "data-table",
          "type": "string"
        }
      },
      "required": [
        "affordances",
        "columns",
        "type"
      ],
      "type": "object"
    },
    "HierarchyConfig": {
      "description": "Configuration for hierarchy/tree components.\n\nHierarchy components display nested or tree-structured data with expand/collapse functionality and hierarchical navigation.\n\nBest used with: data_shape = 'hierarchical'",
      "additionalProperties": false,
      "properties": {
        "affordances": {
          "items": {
            "$ref": "./affordances.schema.json#/definitions/Affordance"
          },
          "type": "array",
          "description": "Interactive capabilities enabled for this hierarchy. Common affordances: search, selection, export"
        },
        "description": {
          "type": "string",
          "description": "Optional description explaining the component's purpose"
        },
        "title": {
          "type": "string",
          "description": "Optional title for the component"
        },
        "type": {
          "const": "hierarchy",
          "type": "string"
        }
      },
      "required": [
        "affordances",
        "type"
      ],
      "type": "object"
    },
    "CompositionConfig": {
      "description": "Configuration for composition components.\n\nCompositions are meta-components that combine multiple sub-components into a unified visualisation (e.g., a dashboard with multiple charts).\n\nBest used with: any data_shape, depending on sub-components",
      "additionalProperties": false,
      "properties": {
        "affordances": {
          "items": {
            "$ref": "./affordances.schema.json#/definitions/Affordance"
          },
          "type": "array",
          "description": "Interactive capabilities for the composition as a whole. Note: sub-components have their own affordances"
        },
        "description": {
          "type": "string",
          "description": "Optional description explaining the component's purpose"
        },
        "title": {
          "type": "string",
          "description": "Optional title for the component"
        },
        "type": {
          "const": "composition",
          "type": "string"
        }
      },
      "required": [
        "affordances",
        "type"
      ],
      "type": "object"
    },
    "TextInsightConfig": {
      "description": "Configuration for text insight components.\n\nText insights display textual information, summaries, or key-value metadata in a readable format.\n\nBest used with: data_shape = 'key_value'",
      "additionalProperties": false,
      "properties": {
        "affordances": {
          "items": {
            "$ref": "./affordances.schema.json#/definitions/Affordance"
          },
          "type": "array",
          "description": "Interactive capabilities for text insights. Common affordances: search, export"
        },
        "description": {
          "type": "string",
          "description": "Optional description explaining the component's purpose"
        },
        "title": {
          "type": "string",
          "description": "Optional title for the component"
        },
        "type": {
          "const": "text-insight",
          "type": "string"
        }
      },
      "required": [
        "affordances",
        "type"
      ],
      "type": "object"
    }
  }
}
